{"version":3,"sources":["hooks/useResizeObserver.js","../node_modules/d3-selection/src/mouse.js","../node_modules/d3-selection/src/sourceEvent.js","../node_modules/d3-selection/src/point.js","components/Timeseries.js"],"names":["useResizeObserver","ref","useState","dimensions","setDimensions","useEffect","observeTarget","current","resizeObserver","ResizeObserver","entries","observer","forEach","entry","index","contentRect","observe","unobserve","node","event","source","sourceEvent","changedTouches","svg","ownerSVGElement","createSVGPoint","point","x","clientX","y","clientY","matrixTransform","getScreenCTM","inverse","rect","getBoundingClientRect","left","clientLeft","top","clientTop","margin","React","memo","timeseries","dates","chartType","isUniform","isLog","t","useTranslation","refs","useRef","wrapperRef","highlightedDate","setHighlightedDate","length","getBarWidth","useCallback","T","axisWidth","width","Math","min","height","chartRight","chartBottom","barWidth","xScale","scaleTime","clamp","domain","parseIndiaDate","range","numTicksX","xAxis","g","attr","call","axisBottom","ticks","tickFormat","date","formatDate","xAxis2","yScale","tickValues","tickSize","select","style","yAxis","axisRight","num","formatNumber","tickPadding","uniformScaleMin","getStatistic","uniformScaleMax","max","yScaleUniformLinear","scaleLinear","nice","yScaleUniformLog","scaleLog","mousemove","xm","mouse","this","invert","isNaN","bisectDate","bisector","dateLeft","dateRight","mouseout","i","transition","duration","D3_TRANSITION_DURATION","statistic","TIMESERIES_STATISTICS","generateYScale","color","STATISTIC_CONFIGS","selectAll","data","join","enter","append","remove","pathLength","linePath","line","curve","curveMonotoneX","getTotalLength","update","attrTween","previous","interpolatePath","on","getStatisticDelta","currCount","prevDate","findIndex","trail","useMemo","styles","map","element","push","animationDelay","Fragment","className","delta","statisticConfig","key","classnames","capitalize","displayName","format","preserveAspectRatio","prevProps","currProps","equal","regionHighlighted","stateCode","districtName"],"mappings":"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","file":"static/js/27.df0bf21b.chunk.js","sourcesContent":["import {ResizeObserver} from '@juggle/resize-observer';\r\nimport {useState, useEffect} from 'react';\r\n\r\nexport const useResizeObserver = (ref) => {\r\n  const [dimensions, setDimensions] = useState(null);\r\n  useEffect(() => {\r\n    const observeTarget = ref.current;\r\n    const resizeObserver = new ResizeObserver((entries, observer) => {\r\n      entries.forEach((entry, index) => {\r\n        setDimensions(entry.contentRect);\r\n      });\r\n    });\r\n    resizeObserver.observe(observeTarget);\r\n    return () => {\r\n      resizeObserver.unobserve(observeTarget);\r\n    };\r\n  }, [ref]);\r\n  return dimensions;\r\n};\r\n\r\nexport default useResizeObserver;\r\n","import sourceEvent from \"./sourceEvent\";\nimport point from \"./point\";\n\nexport default function(node) {\n  var event = sourceEvent();\n  if (event.changedTouches) event = event.changedTouches[0];\n  return point(node, event);\n}\n","import {event} from \"./selection/on\";\n\nexport default function() {\n  var current = event, source;\n  while (source = current.sourceEvent) current = source;\n  return current;\n}\n","export default function(node, event) {\n  var svg = node.ownerSVGElement || node;\n\n  if (svg.createSVGPoint) {\n    var point = svg.createSVGPoint();\n    point.x = event.clientX, point.y = event.clientY;\n    point = point.matrixTransform(node.getScreenCTM().inverse());\n    return [point.x, point.y];\n  }\n\n  var rect = node.getBoundingClientRect();\n  return [event.clientX - rect.left - node.clientLeft, event.clientY - rect.top - node.clientTop];\n}\n","import {\r\n  D3_TRANSITION_DURATION,\r\n  STATISTIC_CONFIGS,\r\n  TIMESERIES_STATISTICS,\r\n} from '../constants';\r\nimport {useResizeObserver} from '../hooks/useResizeObserver';\r\nimport {\r\n  capitalize,\r\n  formatNumber,\r\n  formatDate,\r\n  getStatistic,\r\n  parseIndiaDate,\r\n} from '../utils/commonFunctions';\r\n\r\nimport classnames from 'classnames';\r\nimport {min, max, bisector} from 'd3-array';\r\nimport {axisBottom, axisRight} from 'd3-axis';\r\nimport {interpolatePath} from 'd3-interpolate-path';\r\nimport {scaleTime, scaleLinear, scaleLog} from 'd3-scale';\r\nimport {select, mouse} from 'd3-selection';\r\nimport {line, curveMonotoneX} from 'd3-shape';\r\n// eslint-disable-next-line\r\nimport {transition} from 'd3-transition';\r\nimport equal from 'fast-deep-equal';\r\nimport React, {useCallback, useEffect, useRef, useMemo, useState} from 'react';\r\nimport {useTranslation} from 'react-i18next';\r\n\r\n// Chart margins\r\nconst margin = {top: 15, right: 35, bottom: 25, left: 25};\r\n\r\nfunction Timeseries({timeseries, dates, chartType, isUniform, isLog}) {\r\n  const {t} = useTranslation();\r\n  const refs = useRef([]);\r\n\r\n  const wrapperRef = useRef();\r\n  const dimensions = useResizeObserver(wrapperRef);\r\n\r\n  const [highlightedDate, setHighlightedDate] = useState();\r\n\r\n  useEffect(() => {\r\n    setHighlightedDate(dates[dates.length - 1]);\r\n  }, [dates]);\r\n\r\n  const getBarWidth = useCallback(() => {\r\n    const T = dates.length;\r\n    // Dimensions\r\n    const {width} = dimensions || wrapperRef.current.getBoundingClientRect();\r\n    // Chart extremes\r\n    const chartRight = width - margin.right;\r\n    // Bar widths\r\n    const axisWidth = chartRight - margin.left;\r\n    return Math.min(4, axisWidth / (1.25 * T));\r\n  }, [dates.length, dimensions]);\r\n\r\n  useEffect(() => {\r\n    const T = dates.length;\r\n    // Dimensions\r\n    const {width, height} =\r\n      dimensions || wrapperRef.current.getBoundingClientRect();\r\n    // Chart extremes\r\n    const chartRight = width - margin.right;\r\n    const chartBottom = height - margin.bottom;\r\n    const barWidth = getBarWidth();\r\n\r\n    // Buffer space along y-axis\r\n    const yBufferTop = 1.2;\r\n    const yBufferBottom = 1.1;\r\n\r\n    const xScale = scaleTime()\r\n      .clamp(true)\r\n      .domain(T ? [parseIndiaDate(dates[0]), parseIndiaDate(dates[T - 1])] : [])\r\n      .range([margin.left, chartRight]);\r\n\r\n    // Number of x-axis ticks\r\n    const numTicksX = width < 480 ? 4 : 7;\r\n\r\n    const xAxis = (g) =>\r\n      g.attr('class', 'x-axis').call(\r\n        axisBottom(xScale)\r\n          .ticks(numTicksX)\r\n          .tickFormat((date) => formatDate(date, 'dd MMM'))\r\n      );\r\n\r\n    const xAxis2 = (g, yScale) => {\r\n      g.attr('class', 'x-axis2')\r\n        .call(axisBottom(xScale).tickValues([]).tickSize(0))\r\n        .select('.domain')\r\n        .style('transform', `translateY(${yScale(0)}px)`);\r\n\r\n      if (yScale(0) !== chartBottom) g.select('.domain').attr('opacity', 0.4);\r\n      else g.select('.domain').attr('opacity', 0);\r\n    };\r\n\r\n    const yAxis = (g, yScale) =>\r\n      g.attr('class', 'y-axis').call(\r\n        axisRight(yScale)\r\n          .ticks(4)\r\n          .tickFormat((num) => formatNumber(num, 'short'))\r\n          .tickPadding(4)\r\n      );\r\n\r\n    const uniformScaleMin = min(dates, (date) =>\r\n      getStatistic(timeseries[date], chartType, 'active')\r\n    );\r\n\r\n    const uniformScaleMax = max(dates, (date) =>\r\n      Math.max(\r\n        getStatistic(timeseries[date], chartType, 'confirmed'),\r\n        getStatistic(timeseries[date], chartType, 'recovered'),\r\n        getStatistic(timeseries[date], chartType, 'deceased')\r\n      )\r\n    );\r\n\r\n    const yScaleUniformLinear = scaleLinear()\r\n      .clamp(true)\r\n      .domain([uniformScaleMin, Math.max(1, yBufferTop * uniformScaleMax)])\r\n      .nice(4)\r\n      .range([chartBottom, margin.top]);\r\n\r\n    const yScaleUniformLog = scaleLog()\r\n      .clamp(true)\r\n      .domain([\r\n        Math.max(1, uniformScaleMin),\r\n        Math.max(10, yBufferTop * uniformScaleMax),\r\n      ])\r\n      .nice(4)\r\n      .range([chartBottom, margin.top]);\r\n\r\n    const generateYScale = (statistic) => {\r\n      if (isUniform && chartType === 'total' && isLog && statistic !== 'tested')\r\n        return yScaleUniformLog;\r\n\r\n      if (isUniform && statistic !== 'tested') return yScaleUniformLinear;\r\n\r\n      if (chartType === 'total' && isLog)\r\n        return scaleLog()\r\n          .clamp(true)\r\n          .domain([\r\n            Math.max(\r\n              1,\r\n              min(dates, (date) =>\r\n                getStatistic(timeseries[date], chartType, statistic)\r\n              )\r\n            ),\r\n            Math.max(\r\n              10,\r\n              yBufferTop *\r\n                max(dates, (date) =>\r\n                  getStatistic(timeseries[date], chartType, statistic)\r\n                )\r\n            ),\r\n          ])\r\n          .nice(4)\r\n          .range([chartBottom, margin.top]);\r\n\r\n      return scaleLinear()\r\n        .clamp(true)\r\n        .domain([\r\n          yBufferBottom *\r\n            Math.min(\r\n              0,\r\n              min(dates, (date) =>\r\n                getStatistic(timeseries[date], chartType, statistic)\r\n              )\r\n            ),\r\n          Math.max(\r\n            1,\r\n            yBufferTop *\r\n              max(dates, (date) =>\r\n                getStatistic(timeseries[date], chartType, statistic)\r\n              )\r\n          ),\r\n        ])\r\n        .nice(4)\r\n        .range([chartBottom, margin.top]);\r\n    };\r\n\r\n    function mousemove() {\r\n      const xm = mouse(this)[0];\r\n      const date = xScale.invert(xm);\r\n      if (!isNaN(date)) {\r\n        const bisectDate = bisector((date) => parseIndiaDate(date)).left;\r\n        const index = bisectDate(dates, date, 1);\r\n        const dateLeft = dates[index - 1];\r\n        const dateRight = dates[index];\r\n        setHighlightedDate(\r\n          date - parseIndiaDate(dateLeft) < parseIndiaDate(dateRight) - date\r\n            ? dateLeft\r\n            : dateRight\r\n        );\r\n      }\r\n    }\r\n\r\n    function mouseout() {\r\n      setHighlightedDate(dates[T - 1]);\r\n    }\r\n\r\n    /* Begin drawing charts */\r\n    refs.current.forEach((ref, i) => {\r\n      const svg = select(ref);\r\n      const t = svg.transition().duration(D3_TRANSITION_DURATION);\r\n\r\n      const statistic = TIMESERIES_STATISTICS[i];\r\n      const yScale = generateYScale(statistic);\r\n      const color = STATISTIC_CONFIGS[statistic].color;\r\n\r\n      /* X axis */\r\n      svg\r\n        .select('.x-axis')\r\n        .style('transform', `translateY(${chartBottom}px)`)\r\n        .transition(t)\r\n        .call(xAxis);\r\n\r\n      svg.select('.x-axis2').transition(t).call(xAxis2, yScale);\r\n\r\n      /* Y axis */\r\n      svg\r\n        .select('.y-axis')\r\n        .style('transform', `translateX(${chartRight}px)`)\r\n        .transition(t)\r\n        .call(yAxis, yScale);\r\n\r\n      /* Path dots */\r\n      svg\r\n        .selectAll('circle')\r\n        .data(dates, (date) => date)\r\n        .join((enter) =>\r\n          enter\r\n            .append('circle')\r\n            .attr('fill', color)\r\n            .attr('stroke', color)\r\n            .attr('cy', chartBottom)\r\n            .attr('cx', (date) => xScale(parseIndiaDate(date)))\r\n            .attr('r', barWidth / 2)\r\n        )\r\n        .transition(t)\r\n        .attr('cx', (date) => xScale(parseIndiaDate(date)))\r\n        .attr('cy', (date) =>\r\n          yScale(getStatistic(timeseries[date], chartType, statistic))\r\n        );\r\n\r\n      if (chartType === 'total') {\r\n        svg\r\n          .selectAll('.stem')\r\n          .transition(t)\r\n          .attr('y1', yScale(0))\r\n          .attr('y2', yScale(0))\r\n          .remove();\r\n\r\n        const linePath = line()\r\n          .curve(curveMonotoneX)\r\n          .x((date) => xScale(parseIndiaDate(date)))\r\n          .y((date) =>\r\n            yScale(getStatistic(timeseries[date], chartType, statistic))\r\n          );\r\n\r\n        let pathLength;\r\n\r\n        svg\r\n          .selectAll('.trend')\r\n          .data(T ? [dates] : [])\r\n          .join(\r\n            (enter) =>\r\n              enter\r\n                .append('path')\r\n                .attr('class', 'trend')\r\n                .attr('fill', 'none')\r\n                .attr('stroke', color + '50')\r\n                .attr('stroke-width', 4)\r\n                .attr('d', linePath)\r\n                .attr('stroke-dasharray', function () {\r\n                  return (pathLength = this.getTotalLength());\r\n                })\r\n                .call((enter) =>\r\n                  enter\r\n                    .attr('stroke-dashoffset', pathLength)\r\n                    .transition(t)\r\n                    .attr('stroke-dashoffset', 0)\r\n                ),\r\n            (update) =>\r\n              update\r\n                .attr('stroke-dasharray', null)\r\n                .transition(t)\r\n                .attrTween('d', function (date) {\r\n                  const previous = select(this).attr('d');\r\n                  const current = linePath(date);\r\n                  return interpolatePath(previous, current);\r\n                })\r\n          );\r\n      } else {\r\n        /* DAILY TRENDS */\r\n        svg.selectAll('.trend').remove();\r\n\r\n        svg\r\n          .selectAll('.stem')\r\n          .data(dates, (date) => date)\r\n          .join((enter) =>\r\n            enter\r\n              .append('line')\r\n              .attr('class', 'stem')\r\n              .attr('stroke-width', barWidth)\r\n              .attr('x1', (date) => xScale(parseIndiaDate(date)))\r\n              .attr('y1', chartBottom)\r\n              .attr('x2', (date) => xScale(parseIndiaDate(date)))\r\n              .attr('y2', chartBottom)\r\n          )\r\n          .transition(t)\r\n          .attr('stroke-width', barWidth)\r\n          .attr('x1', (date) => xScale(parseIndiaDate(date)))\r\n          .attr('y1', yScale(0))\r\n          .attr('x2', (date) => xScale(parseIndiaDate(date)))\r\n          .attr('y2', (date) =>\r\n            yScale(getStatistic(timeseries[date], chartType, statistic))\r\n          );\r\n      }\r\n\r\n      svg.selectAll('*').attr('pointer-events', 'none');\r\n      svg\r\n        .on('mousemove', mousemove)\r\n        .on('touchmove', mousemove)\r\n        .on('mouseout', mouseout)\r\n        .on('touchend', mouseout);\r\n    });\r\n  }, [chartType, dimensions, getBarWidth, isUniform, isLog, timeseries, dates]);\r\n\r\n  useEffect(() => {\r\n    const barWidth = getBarWidth();\r\n    refs.current.forEach((ref) => {\r\n      const svg = select(ref);\r\n      svg\r\n        .selectAll('circle')\r\n        .attr('r', (date) =>\r\n          date === highlightedDate ? barWidth : barWidth / 2\r\n        );\r\n    });\r\n  }, [highlightedDate, getBarWidth]);\r\n\r\n  const getStatisticDelta = useCallback(\r\n    (statistic) => {\r\n      if (!highlightedDate) return;\r\n      const currCount = getStatistic(\r\n        timeseries?.[highlightedDate],\r\n        chartType,\r\n        statistic\r\n      );\r\n      const prevDate =\r\n        dates[dates.findIndex((date) => date === highlightedDate) - 1];\r\n\r\n      const prevCount = getStatistic(\r\n        timeseries?.[prevDate],\r\n        chartType,\r\n        statistic\r\n      );\r\n      return currCount - prevCount;\r\n    },\r\n    [timeseries, dates, highlightedDate, chartType]\r\n  );\r\n\r\n  const trail = useMemo(() => {\r\n    const styles = [];\r\n\r\n    [0, 0, 0, 0, 0].map((element, index) => {\r\n      styles.push({\r\n        animationDelay: `${index * 250}ms`,\r\n      });\r\n      return null;\r\n    });\r\n    return styles;\r\n  }, []);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"Timeseries\">\r\n        {TIMESERIES_STATISTICS.map((statistic, index) => {\r\n          const delta = getStatisticDelta(statistic, index);\r\n          const statisticConfig = STATISTIC_CONFIGS[statistic];\r\n          return (\r\n            <div\r\n              key={statistic}\r\n              className={classnames('svg-parent fadeInUp', `is-${statistic}`)}\r\n              ref={wrapperRef}\r\n              style={trail[index]}\r\n            >\r\n              {highlightedDate && (\r\n                <div className={classnames('stats', `is-${statistic}`)}>\r\n                  <h5 className=\"title\">\r\n                    {t(capitalize(statisticConfig.displayName))}\r\n                  </h5>\r\n                  <h5 className=\"title\">\r\n                    {formatDate(highlightedDate, 'dd MMMM')}\r\n                  </h5>\r\n                  <div className=\"stats-bottom\">\r\n                    <h2>\r\n                      {formatNumber(\r\n                        getStatistic(\r\n                          timeseries?.[highlightedDate],\r\n                          chartType,\r\n                          statistic\r\n                        ),\r\n                        statisticConfig.format !== 'short'\r\n                          ? statisticConfig.format\r\n                          : 'int',\r\n                        statistic\r\n                      )}\r\n                    </h2>\r\n                    <h6>{`${delta > 0 ? '+' : ''}${formatNumber(\r\n                      delta,\r\n                      statisticConfig.format !== 'short'\r\n                        ? statisticConfig.format\r\n                        : 'int',\r\n                      statistic\r\n                    )}`}</h6>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              <svg\r\n                ref={(element) => {\r\n                  refs.current[index] = element;\r\n                }}\r\n                preserveAspectRatio=\"xMidYMid meet\"\r\n              >\r\n                <g className=\"x-axis\" />\r\n                <g className=\"x-axis2\" />\r\n                <g className=\"y-axis\" />\r\n              </svg>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nconst isEqual = (prevProps, currProps) => {\r\n  if (!equal(currProps.chartType, prevProps.chartType)) {\r\n    return false;\r\n  } else if (!equal(currProps.isUniform, prevProps.isUniform)) {\r\n    return false;\r\n  } else if (!equal(currProps.isLog, prevProps.isLog)) {\r\n    return false;\r\n  } else if (\r\n    !equal(\r\n      currProps.regionHighlighted.stateCode,\r\n      prevProps.regionHighlighted.stateCode\r\n    )\r\n  ) {\r\n    return false;\r\n  } else if (\r\n    !equal(\r\n      currProps.regionHighlighted.districtName,\r\n      prevProps.regionHighlighted.districtName\r\n    )\r\n  ) {\r\n    return false;\r\n  } else if (!equal(currProps.dates, prevProps.dates)) {\r\n    return false;\r\n  }\r\n  return true;\r\n};\r\n\r\nexport default React.memo(Timeseries, isEqual);\r\n"],"sourceRoot":""}